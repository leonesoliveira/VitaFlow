function bdaterange_start(c,a){let d=document.getElementById(a.id_start),g=document.getElementById(a.id_end);$(d).data("range_type","normal");let m={element:d,css:["lib/independent/css/easepick.css"],header:a.title,zIndex:a.zIndex,grid:a.grid,calendars:a.calendars,readonly:!1,autoApply:a.autoApply,plugins:["RangePlugin","LockPlugin"],lang:a.language,format:a.format,locale:{cancel:"pt"==a.language?"Cancelar":"Cancel",apply:"pt"==a.language?"Aplicar":"Apply"},setup(k){k.on("select",e=>{a.changeaction&&
eval(a.changeaction)})},RangePlugin:{delimiter:a.separator,tooltipNumber:k=>k-1,locale:a.locale??{one:"pt"==a.language?"Dia":"Day",other:"pt"==a.language?"Dias":"Days"}}};a.time&&(m.plugins.push("TimePlugin"),m.TimePlugin={seconds:a.seconds,format:"HH:mm:ss",stepSeconds:a.stepSeconds,stepHours:a.stepHours,stepMinutes:a.stepMinutes});a.id_end&&($(d).data("range_type","start"),$(g).data("range_type","end"),m.RangePlugin.elementEnd=g);if(a.enableDates||a.disableDates)m.LockPlugin={minDate:new Date,minDays:1,
inseparable:!0,filter(k){if(a.enableDates)return!a.enableDates.includes(k.format("YYYY-MM-DD"));if(a.disableDates)return a.disableDates.includes(k.format("YYYY-MM-DD"))}};const b=new easepick.create(m);$(d).on("change",function(){if(this.value)b.setStartDate(this.value);else{let k=$(g).val();b.clear();g&&k&&b.setEndDate(k)}a.changeaction&&eval(a.changeaction)});$(g).on("change",function(){if(this.value)b.setEndDate(this.value);else{let k=$(d).val();b.clear();k&&b.setStartDate(k)}a.changeaction&&eval(a.changeaction)});
$("#"+c).data("picker",b)}function bdaterange_disable_field(c,a){let d=$("form[name="+c+"] [id="+a+"]");0==d.length&&(d=$("form[name="+c+"] [name="+a+"]").closest(".bdaterange-container"));d.find(".bdaterange-icon").hide();d.find("input").addClass("tfield_disabled")}
function bdaterange_enable_field(c,a){let d=$("form[name="+c+"] [id="+a+"]");0==d.length&&(d=$("form[name="+c+"] [name="+a+"]").closest(".bdaterange-container"));d.find(".bdaterange-icon").show();d.find("input").removeClass("tfield_disabled")}
function bdaterange_set_value(c,a){"normal"==$(c).data("range_type")?$(c).closest(".bdaterange-container").data("picker").setDateRange(a):"end"==$(c).data("range_type")?$(c).closest(".bdaterange-container").data("picker").setEndDate(a):"start"==$(c).data("range_type")&&$(c).closest(".bdaterange-container").data("picker").setStartDate(a);$(c).val(a)};function btreeview_start(c,a){if(a)$(`#${c} .btreeview-group-name, #${c} .btreeview-group-icon`).on("click",function(d){$(this).closest(".btreeview-group").toggleClass("btreeview-open")})}function btreeview_toggle_all(c,a){c.stopPropagation();$(a).closest(".btreeview-group").find(".btreeview-group-items").find("[type=checkbox]").prop("checked",$(a).is(":checked"))}
function btreeview_add_option(c,a,d,g,m){d=$("form[name="+c+"] [btreeview="+a+'] .btreeview-group[id="'+d+'"]');c=d.find(".btreeview-group-items .btreeview-item:first").clone();a=c.attr("data-id");console.log(c,d,a);c.find(".btreeview-checkbox-item").attr("value",g);c.find("span").html(m);c.attr("data-id",g);d.find(".btreeview-group-items").append(c)}function btreeview_reload(c,a,d){$("form[name="+c+"] [btreeview="+a+"]").replaceWith(base64_decode(d))};function bselectcheck_start(c,a){function d(e){const f=e.data("select2").$dropdown;if(f&&f.length){f.find(".select2-results__option:visible").each(function(){var n=$(this).data("data");if(n&&n.id){n=e.find('option[value="'+n.id+'"]').prop("selected");const q=$(this).find(".select2-result-item__checkbox");q.length&&(q.prop("checked",n),$(this).attr("aria-selected",n?"true":"false"))}});var h=e.data("select2");if(h&&h.data&&h.data()){h=h.data();for(let n=0;n<h.length;n++){var l=h[n];if(l&&l.id){const q=
e.find('option[value="'+l.id+'"]').prop("selected");l=f.find(`.select2-results__option[aria-selected][id$="-${l.id}"]`);l.length&&(l.find(".select2-result-item__checkbox").prop("checked",q),l.attr("aria-selected",q?"true":"false"))}}}}}let g=!1;var m={allowClear:!0,multiple:!0,closeOnSelect:!1,placeholder:a,templateSelection:function(e,f){return e.text},templateResult:function(e){if(e.loading)return e.text;var f=$('<div class="select2-result-item">'+("OPTGROUP"===e.element.tagName?"":'<input type="checkbox" class="select2-result-item__checkbox">')+
'<span class="select2-result-item__text">'+e.text+"</span></div>");"OPTGROUP"!==e.element.tagName&&e.id&&f.find('input[type="checkbox"]').attr("data-option-value",e.id);e=$(e.element).is(":selected");f.find('input[type="checkbox"]').prop("checked",e);return f}};$(c).removeAttr("onchange");const b=$(c).select2(m);b.data("original-element",c);b.on("change",function(e){bselectcheck_update_summary(this,a);g||setTimeout(function(){d(b)},10)});b.on("select2:close",function(){$(c).attr("changeaction")&&
(new Function($(c).attr("changeaction")))()});b.on("select2:open",function(){setTimeout(function(){d(b)},50)});b.on("select2:select select2:unselect",function(){setTimeout(function(){d(b)},10)});const k=function(){const e=b.data("select2").$dropdown;e.is(":visible")&&e.find(".select2-results__option").each(function(){var f=$(this).data("data")?.id;if(f){f=b.find('option[value="'+f+'"]').prop("selected");const h=$(this).find('input[type="checkbox"]');h.prop("checked")!==f&&(h.prop("checked",f),$(this).attr("aria-selected",
f?"true":"false"))}})};b.on("select2:rendered",function(){k()});b.on("mouseup",".select2-results__option",function(){$(this).data("data");setTimeout(function(){k()},50)});b.on("select2:unselecting",function(e){$(this).data("unselecting",!0);setTimeout(()=>$(this).removeData("unselecting"),10)}).on("select2:opening",function(e){$(this).data("unselecting")&&($(this).removeData("unselecting"),e.preventDefault())});b.on("select2:clearing",function(e){var f=$(this).next(".select2-container");setTimeout(function(){f.find(".select2-selection__rendered").html('<li class="select2-selection__placeholder">'+
a+"</li>")})});$(document).off("click",".select2-results__option, .select2-result-item__checkbox").on("click",".select2-results__option, .select2-result-item__checkbox",function(e){const f=$(e.target).hasClass("select2-result-item__checkbox")?$(this).closest(".select2-results__option"):$(this);e.preventDefault();e.stopPropagation();if(!f.data("data"))return!1;e=f.data("data").id;const h=f.closest(".select2-results").siblings(".select2-search--dropdown").closest(".select2-container").siblings("select");
if(!h.length)return!1;var l=h.find(`option[value="${e}"]`).prop("selected");g=!0;try{l=!l,h.find(`option[value="${e}"]`).prop("selected",l),f.find(".select2-result-item__checkbox").prop("checked",l),f.attr("aria-selected",l?"true":"false"),h.trigger("change"),bselectcheck_update_summary(h,a)}finally{g=!1}return!1});$(document).off("click",".select2-selection").on("click",".select2-selection",function(e){const f=$(this).closest(".select2-container").siblings("select");f.length&&setTimeout(function(){f.select2("open")},
10)});m=$(c).next(".select2-container");m.find(".select2-selection__arrow").length||m.find(".select2-selection").append('<span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>');b.data("select2").$dropdown.addClass("bselectcheck");b.data("select2").$container.addClass("bselectcheck-container");bselectcheck_update_summary(c,a);b.on("select2:open",function(){const e=b.data("select2").$dropdown;var f=$(this).next(".select2-container").outerWidth();e.css("width",
f+"px");e.find(".bselectcheck-custom-dropdown-header").remove();var h=$('<input type="text" class="bselectcheck-custom-search-input">'),l=$('<div class="bselectcheck-buttons-container"></div>');f=$('<span  class="bselectcheck-btn btn btn-default btn-sm pull-left"> <i class="far fa-check-square" style=";padding-right:4px"></i> </button>');var n=$('<span  class="bselectcheck-btn btn btn-default btn-sm pull-left"><i class="far fa-square" style=";padding-right:4px"></i></button>'),q=$('<span  class="bselectcheck-btn btn btn-default btn-sm pull-left"><i class="fas fa-retweet" style=";padding-right:4px"></i></button>');
l.append(f,n,q);l=$('<div class="bselectcheck-custom-dropdown-header"></div>').append(h).append(l);e.prepend(l);f.on("click",function(p){p.preventDefault();p.stopPropagation();g=!0;try{b.find("option").prop("selected",!0),b.data("select2").$dropdown.find(".select2-results__option:visible").each(function(){$(this).attr("aria-selected","true");$(this).find(".select2-result-item__checkbox").prop("checked",!0)}),b.trigger("change"),bselectcheck_update_summary(b,a),setTimeout(function(){d(b)},50)}finally{g=
!1}});n.on("click",function(p){p.preventDefault();p.stopPropagation();g=!0;try{b.find("option").prop("selected",!1),b.data("select2").$dropdown.find(".select2-results__option:visible").each(function(){$(this).attr("aria-selected","false");$(this).find(".select2-result-item__checkbox").prop("checked",!1)}),b.trigger("change"),bselectcheck_update_summary(b,a),setTimeout(function(){d(b)},50)}finally{g=!1}});q.off("click").on("click",function(p){p.preventDefault();p.stopPropagation();g=!0;try{const t=
b.data("select2").$dropdown;if(t&&0!==t.length){var v=t.find(".select2-results__option:visible .select2-result-item__checkbox[data-option-value]");0!==v.length&&(v.each(function(r){if(r=$(this).attr("data-option-value"))if(r=b.find(`option[value="${r}"]`),0!==r.length){var u=!r.prop("selected");r.prop("selected",u);$(this).prop("checked",u);$(this).closest(".select2-results__option").attr("aria-selected",u?"true":"false")}}),b.trigger("change"),bselectcheck_update_summary(b,a),setTimeout(function(){d(b)},
100))}}catch(t){console.error("ERRO DURANTE INVERS\u00c3O:",t)}finally{g=!1}});setTimeout(function(){d(b)},100);h.on("input",function(){var p=$(this).val().toLowerCase();e.find(".select2-results__options li").each(function(){$(this).hasClass("select2-results__message")||($(this).text().toLowerCase().includes(p)?$(this).show():$(this).hide())})});setTimeout(function(){h.focus()},0)});b.on("select2:select select2:unselect",function(e){var f=e.params.data.selected;"undefined"!=typeof e.params.originalEvent&&
$(e.params.originalEvent.currentTarget).find('input[type="checkbox"]').prop("checked",f);b.find('option[value="'+e.params.data.id+'"]').prop("selected");setTimeout(function(){b.data("select2").$dropdown.find(".select2-results__option").each(function(){var h=$(this).data("data")?.id;h&&(h=b.find('option[value="'+h+'"]').prop("selected"),$(this).find('input[type="checkbox"]').prop("checked",h),$(this).attr("aria-selected",h?"true":"false"))})},10)});b.on("select2:clearing",function(e){var f=$(this).next(".select2-container");
setTimeout(function(){f.find(".select2-selection__rendered").html('<li class="select2-selection__placeholder">'+a+"</li>")})})}
function bselectcheck_update_summary(c,a){var d=$(c);c=d.select2("data");const g=c?.length,m=d.next(".select2-container");d=m.find(".select2-selection__rendered");if(0===g)d.find("li:not(.select2-search--inline)").remove(),d.find(".select2-selection__choice, .select2-selection__clear").remove(),d.prepend(`<li class="select2-selection__placeholder">${a}</li>`);else{const {visibleText:b,remainingCount:k}=bselectcheck_calculate_visible_items(m,c);a=b;0<k&&(a+=` (+${k} itens)`);d.find("li:not(.select2-search--inline)").remove();
d.prepend(`<span style="width: 100%;max-width: 100%;"class="select2-selection__choice">${a}</span>`)}}
function bselectcheck_calculate_visible_items(c,a){const d=$("<span>").css({"font-size":c.css("font-size"),"font-family":c.css("font-family"),visibility:"hidden",position:"absolute","white-space":"nowrap"}).appendTo("body");c=c.width()-80;let g=[],m=0;a=a?.filter(b=>b&&b.text?.trim());for(let b=0;b<a?.length;b++){const k=0===g.length?a[b].text.trim():g.join(", ")+", "+a[b].text.trim();d.text(b<a.length-1?k+` (+${a.length-b-1} itens)`:k);if(c<d.width()){m=a.length-b;break}g.push(a[b].text.trim())}d.remove();
return{visibleText:0<g.length?g.join(", "):"",remainingCount:m}};
